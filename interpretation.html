<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>塔罗牌解读 - 命运指引</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: radial-gradient(circle at center, #0a0a0f, #000);
  font-family: "Noto Serif SC", serif;
  color: #f3e8d8;
  min-height: 100vh;
  overflow-x: hidden;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* 头部样式 */
.header {
  text-align: center;
  margin-bottom: 30px;
  padding: 20px 0;
  border-bottom: 1px solid rgba(255,215,0,0.3);
}

.header h1 {
  font-size: 2.5rem;
  color: #ffd700;
  text-shadow: 0 0 20px rgba(255,215,0,0.5);
  margin-bottom: 10px;
}

.header p {
  font-size: 1.1rem;
  opacity: 0.8;
}

/* 牌阵显示 */
.cards-layout {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-bottom: 40px;
  flex-wrap: wrap;
}

.card-slot {
  text-align: center;
  width: 200px;
}

.card-image {
  width: 140px;
  height: 220px;
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.8);
  margin-bottom: 15px;
  border: 2px solid #ffd700;
  object-fit: cover;
}

.position-label {
  font-size: 1.2rem;
  color: #ffd700;
  margin-bottom: 10px;
  font-weight: bold;
}

.card-name {
  font-size: 1.1rem;
  color: #fff;
  font-weight: bold;
}

/* 解读区域 */
.interpretation-section {
  background: rgba(255,255,255,0.05);
  border-radius: 15px;
  padding: 30px;
  margin-bottom: 30px;
  border: 1px solid rgba(255,215,0,0.2);
}

.section-title {
  color: #ffd700;
  font-size: 1.5rem;
  margin-bottom: 20px;
  text-align: center;
}

.individual-readings {
  display: grid;
  gap: 20px;
  margin-bottom: 30px;
}

.reading-item {
  background: rgba(255,255,255,0.03);
  padding: 20px;
  border-radius: 10px;
  border-left: 4px solid #ffd700;
}

.reading-title {
  color: #ffd700;
  font-size: 1.2rem;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.reading-content {
  line-height: 1.7;
  text-align: justify;
}

/* 综合解读 */
.summary-reading {
  background: rgba(255,215,0,0.1);
  padding: 25px;
  border-radius: 10px;
  border: 1px solid rgba(255,215,0,0.3);
}

/* AI对话区域 */
.chat-section {
  background: rgba(255,255,255,0.05);
  border-radius: 15px;
  padding: 25px;
  border: 1px solid rgba(255,215,0,0.2);
}

.chat-messages {
  height: 300px;
  overflow-y: auto;
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(0,0,0,0.3);
  border-radius: 10px;
  border: 1px solid rgba(255,215,0,0.1);
}

.message {
  margin-bottom: 15px;
  padding: 12px 15px;
  border-radius: 10px;
  line-height: 1.5;
  max-width: 80%;
}

.user-message {
  background: rgba(255,215,0,0.2);
  margin-left: auto;
  border: 1px solid rgba(255,215,0,0.3);
}

.ai-message {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

.chat-input-area {
  display: flex;
  gap: 10px;
}

.chat-input {
  flex: 1;
  padding: 12px 15px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,215,0,0.3);
  border-radius: 8px;
  color: #fff;
  font-size: 1rem;
  outline: none;
}

.chat-input:focus {
  border-color: #ffd700;
}

.send-button {
  padding: 12px 25px;
  background: linear-gradient(135deg, #ffd700, #ffed4e);
  color: #000;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

.send-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255,215,0,0.4);
}

/* 控制按钮 */
.controls {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
}

.control-btn {
  padding: 12px 30px;
  background: linear-gradient(45deg, rgba(255,215,0,0.3), rgba(255,215,0,0.1));
  color: #ffd700;
  border: 2px solid #ffd700;
  border-radius: 25px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s ease;
  text-decoration: none;
}

.control-btn:hover {
  background: linear-gradient(45deg, rgba(255,215,0,0.5), rgba(255,215,0,0.2));
  transform: translateY(-2px);
}

/* 加载动画 */
.loading {
  text-align: center;
  color: #ffd700;
  font-style: italic;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .cards-layout {
    gap: 20px;
  }
  
  .card-slot {
    width: 150px;
  }
  
  .card-image {
    width: 120px;
    height: 180px;
  }
  
  .message {
    max-width: 90%;
  }
  
  .header h1 {
    font-size: 2rem;
  }
}

/* 滚动条样式 */
.chat-messages::-webkit-scrollbar {
  width: 6px;
}

.chat-messages::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.1);
  border-radius: 3px;
}

.chat-messages::-webkit-scrollbar-thumb {
  background: #ffd700;
  border-radius: 3px;
}
</style>
</head>
<body>
<div class="container">
  <!-- 头部 -->
  <div class="header">
    <h1>🔮 塔罗牌解读</h1>
    <p>命运之轮已经转动，以下是您的牌阵解读</p>
  </div>

  <!-- 牌阵显示 -->
  <div class="cards-layout" id="cardsLayout">
    <!-- 动态生成牌位 -->
  </div>

  <!-- 解读区域 -->
  <div class="interpretation-section">
    <h2 class="section-title">📜 详细解读</h2>
    
    <div class="individual-readings" id="individualReadings">
      <!-- 动态生成单张牌解读 -->
    </div>
    
    <div class="summary-reading" id="summaryReading">
      <h3 class="reading-title">🌟 综合解读</h3>
      <div class="reading-content" id="summaryContent">
        <!-- 动态生成综合解读 -->
      </div>
    </div>
  </div>

  <!-- AI对话区域 -->
  <div class="chat-section">
    <h2 class="section-title">💬 与塔罗师对话</h2>
    <div class="chat-messages" id="chatMessages">
      <div class="message ai-message">
        您好！我是您的塔罗师。我已经为您解读了抽到的牌阵，如果您有任何疑问或想深入了解某个方面，请随时问我。
      </div>
    </div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" id="chatInput" placeholder="请输入您的问题...">
      <button class="send-button" id="sendButton">发送</button>
    </div>
  </div>

  <!-- 控制按钮 -->
  <div class="controls">
    <button class="control-btn" id="newReadingBtn">重新抽牌</button>
    <a href="index.html" class="control-btn">返回首页</a>
  </div>
</div>

<script>
// 塔罗牌解读数据
const tarotInterpretations = {
  "The Fool": {
    upright: "新的开始、冒险、自由、天真、自发性",
    reversed: "鲁莽、风险、犹豫不决、愚蠢",
    meaning: "愚者代表着新的旅程和无限的可能性，鼓励你勇敢迈出第一步。"
  },
  "The Magician": {
    upright: "意志力、技能、创造力、 Manifestation",
    reversed: "操纵、未使用的潜力、欺骗",
    meaning: "魔术师象征着你拥有实现目标所需的所有工具和能力。"
  },
  "The High Priestess": {
    upright: "直觉、神秘、潜意识、神圣女性",
    reversed: "秘密、被忽视的直觉、肤浅",
    meaning: "女祭司提醒你要倾听内心的声音和直觉的指引。"
  },
  "The Empress": {
    upright: "丰饶、创造力、自然、母性",
    reversed: "创造性障碍、依赖、疏忽",
    meaning: "女皇代表着丰盛和创造力，鼓励你滋养自己和他人。"
  },
  "The Emperor": {
    upright: "权威、结构、控制、父亲形象",
    reversed: "支配、僵化、缺乏纪律",
    meaning: "皇帝象征着结构和秩序，提醒你要建立稳固的基础。"
  },
  "The Hierophant": {
    upright: "传统、信仰、教育、服从",
    reversed: "叛逆、新方法、不受欢迎的忠告",
    meaning: "教皇代表着传统和信仰体系，鼓励你寻求精神指导。"
  },
  "The Lovers": {
    upright: "爱情、和谐、伙伴关系、价值观",
    reversed: "失衡、错误选择、不和谐",
    meaning: "恋人牌关乎选择和关系，提醒你要忠于自己的价值观。"
  },
  "The Chariot": {
    upright: "控制、意志力、胜利、主张",
    reversed: "缺乏方向、侵略、没有控制",
    meaning: "战车象征着通过意志力和决心克服挑战。"
  },
  "Strength": {
    upright: "勇气、影响力、耐心、同情心",
    reversed: "内在力量、不安全感、原始情绪",
    meaning: "力量牌教导我们真正的力量来自内心而非暴力。"
  },
  "The Hermit": {
    upright: "内省、沉思、孤独、引导",
    reversed: "孤立、退缩、拒绝帮助",
    meaning: "隐士鼓励你进行内省和寻找内在的智慧。"
  },
  "Wheel of Fortune": {
    upright: "命运、转折点、运气、循环",
    reversed: "不幸、抵抗变化、坏运气",
    meaning: "命运之轮提醒你生命是不断变化的循环。"
  },
  "Justice": {
    upright: "正义、公平、真相、因果",
    reversed: "不公正、缺乏问责、不诚实",
    meaning: "正义牌强调因果报应和做出公正的决定。"
  },
  "The Hanged Man": {
    upright: "暂停、投降、新视角、启蒙",
    reversed: "拖延、抵抗、僵局",
    meaning: "倒吊人教导我们从不同角度看待问题。"
  },
  "Death": {
    upright: "结束、转变、过渡、放手",
    reversed: "抵抗变化、停滞、恐惧放手",
    meaning: "死神牌象征必要的结束和新开始的转变。"
  },
  "Temperance": {
    upright: "平衡、适度、耐心、目的",
    reversed: "不平衡、过度、不和谐",
    meaning: "节制牌鼓励你在生活中寻找平衡和和谐。"
  },
  "The Devil": {
    upright: "束缚、成瘾、唯物主义、无力",
    reversed: "独立、释放限制、精神觉醒",
    meaning: "恶魔牌提醒我们注意物质束缚和负面模式。"
  },
  "The Tower": {
    upright: "突然变化、启示、崩溃、觉醒",
    reversed: "避免灾难、恐惧改变、压抑",
    meaning: "高塔象征着突然的觉醒和必要的破坏。"
  },
  "The Star": {
    upright: "希望、信仰、目的、更新",
    reversed: "绝望、信仰丧失、不信任",
    meaning: "星星牌带来希望和灵感，指引你前进的方向。"
  },
  "The Moon": {
    upright: "幻觉、恐惧、焦虑、潜意识",
    reversed: "释放恐惧、压抑情绪、误解",
    meaning: "月亮牌揭示潜意识的恐惧和需要面对的影子。"
  },
  "The Sun": {
    upright: "快乐、成功、庆祝、积极",
    reversed: "暂时的挫折、成功延迟、过度自负",
    meaning: "太阳牌带来成功、快乐和积极能量。"
  },
  "Judgement": {
    upright: "反思、再生、内在召唤、赦免",
    reversed: "自我怀疑、拒绝召唤、缺乏意识",
    meaning: "审判牌呼唤自我反思和精神觉醒。"
  },
  "The World": {
    upright: "完成、成就、旅行、综合",
    reversed: "未完成、缺乏完成、恐惧移动",
    meaning: "世界牌象征旅程的完成和成就的达成。"
  }
};

// 从localStorage获取选中的牌
const selectedCards = JSON.parse(localStorage.getItem('selectedTarotCards') || '[]');

// 初始化页面
document.addEventListener('DOMContentLoaded', function() {
  displayCards();
  generateInterpretations();
  setupChat();
  setupControls();
});

// 显示选中的牌
function displayCards() {
  const cardsLayout = document.getElementById('cardsLayout');
  const positions = ['过去', '现在', '未来'];
  
  cardsLayout.innerHTML = '';
  
  selectedCards.forEach((card, index) => {
    const cardSlot = document.createElement('div');
    cardSlot.className = 'card-slot';
    
    cardSlot.innerHTML = `
      <div class="position-label">${positions[index]}</div>
      <img src="${card.img}" alt="${card.name}" class="card-image" 
           onerror="this.src='img/back.jpg'; this.alt='图片加载失败'">
      <div class="card-name">${card.name}</div>
    `;
    
    cardsLayout.appendChild(cardSlot);
  });
}

// 生成解读
function generateInterpretations() {
  const individualReadings = document.getElementById('individualReadings');
  const summaryContent = document.getElementById('summaryContent');
  
  // 生成单张牌解读
  individualReadings.innerHTML = '';
  const positions = ['过去', '现在', '未来'];
  
  selectedCards.forEach((card, index) => {
    const interpretation = tarotInterpretations[card.name] || {
      upright: "未知",
      reversed: "未知", 
      meaning: "这张牌的意义需要进一步探索。"
    };
    
    const readingItem = document.createElement('div');
    readingItem.className = 'reading-item';
    
    readingItem.innerHTML = `
      <div class="reading-title">
        <span>${positions[index]}: ${card.name}</span>
      </div>
      <div class="reading-content">
        <strong>正位:</strong> ${interpretation.upright}<br>
        <strong>逆位:</strong> ${interpretation.reversed}<br><br>
        ${interpretation.meaning}
      </div>
    `;
    
    individualReadings.appendChild(readingItem);
  });
  
  // 生成综合解读
  const summary = generateSummaryInterpretation();
  summaryContent.textContent = summary;
}

// 生成综合解读
function generateSummaryInterpretation() {
  if (selectedCards.length === 0) return "请先抽取牌阵。";
  
  const cardNames = selectedCards.map(card => card.name).join('、');
  const positions = ['过去的影响', '现在的状况', '未来的发展'];
  
  return `您的牌阵由 ${cardNames} 组成，展现了从${positions[0]}到${positions[2]}的完整旅程。这三张牌共同讲述了一个关于成长、挑战和转变的故事，指引您理解生命周期的自然流动。请结合个人情况，深思每张牌带给您的启示。`;
}

// 设置聊天功能
function setupChat() {
  const chatInput = document.getElementById('chatInput');
  const sendButton = document.getElementById('sendButton');
  const chatMessages = document.getElementById('chatMessages');
  
  function sendMessage() {
    const message = chatInput.value.trim();
    if (!message) return;
    
    // 添加用户消息
    addMessage(message, 'user');
    chatInput.value = '';
    
    // 模拟AI回复
    setTimeout(() => {
      const aiResponse = generateAIResponse(message);
      addMessage(aiResponse, 'ai');
    }, 1000);
  }
  
  sendButton.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendMessage();
  });
}

// 添加消息到聊天框
function addMessage(text, sender) {
  const chatMessages = document.getElementById('chatMessages');
  const messageDiv = document.createElement('div');
  messageDiv.className = `message ${sender}-message`;
  messageDiv.textContent = text;
  
  chatMessages.appendChild(messageDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

// 生成AI回复
function generateAIResponse(userMessage) {
  const responses = [
    "根据您抽到的牌阵，这个问题与您当前的生命阶段密切相关。",
    "牌面显示您正经历重要的转变期，需要更多的自我反思。",
    "让我结合您抽到的三张牌，为您深入分析这个问题...",
    "塔罗提示您需要关注内心的声音，外在的答案往往在内心。",
    "从牌阵来看，这个问题涉及到平衡与选择的智慧。",
    "您的问题与牌面显示的成长主题高度相关，建议耐心对待过程。",
    "牌面暗示您已经拥有解决问题的内在资源，只是需要时间去发现。"
  ];
  
  const cardReferences = selectedCards.map(card => 
    `特别是${card.name}这张牌，它提醒您${tarotInterpretations[card.name]?.meaning || '关注内在智慧'}`
  ).join('。');
  
  return `${responses[Math.floor(Math.random() * responses.length)]} ${cardReferences}。您对这个解读有什么想法吗？`;
}

// 设置控制按钮
function setupControls() {
  document.getElementById('newReadingBtn').addEventListener('click', function() {
    if (confirm('确定要重新抽牌吗？当前解读将会丢失。')) {
      window.location.href = 'index.html';
    }
  });
}
</script>
</body>
</html>